import{g as e,d as a,u as l,c as t}from"./menu-CzKWJdH9.js";import{u as o}from"./index-CFSbY6bd.js";import{I as u,E as d,a as r}from"./element-plus-CCDyQ1z5.js";import{x as i,c as n,ag as s,y as p,G as c,H as m,P as v,A as f,z as _,a4 as h,u as y,O as b,J as g,M as V,r as k,k as w,aq as x,L as C,I as U,K as I}from"./vendor-BVd4RN3d.js";import{_ as j}from"./_plugin-vue_export-helper-BCo6x5W8.js";const A={class:"icon-list"},q=["onClick"],O={class:"icon-name"},z=j(i({__name:"index",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:a}){const l=e,t=a,o=n({get:()=>l.modelValue,set:e=>t("update:modelValue",e)}),d=Object.keys(u);return(e,a)=>{const l=s("el-input"),t=s("el-icon"),r=s("el-popover");return p(),c(r,{placement:"bottom",width:300,trigger:"click","popper-class":"icon-select-popover"},{reference:m((()=>{return[v(l,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),placeholder:"点击选择图标",readonly:"","suffix-icon":o.value?(e=o.value,u[e]):""},null,8,["modelValue","suffix-icon"])];var e})),default:m((()=>[f("div",A,[(p(!0),_(b,null,h(y(d),(e=>(p(),_("div",{key:e,class:"icon-item",onClick:a=>(e=>{o.value=e})(e)},[v(t,null,{default:m((()=>[(p(),c(g(e)))])),_:2},1024),f("span",O,V(e),1)],8,q)))),128))])])),_:1})}}}),[["__scopeId","data-v-e5a85411"]]),E={class:"app-container"},F={class:"toolbar"},G=j(i({__name:"index",setup(u){const i=k(!1),n=k([]),h=k(!1),y=k(""),b=k(!1),g=k(),V=k({name:"",path:"",icon:"",sort:0,parent_id:null}),j={name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],icon:[{required:!0,message:"请输入图标名称",trigger:"blur"}]},A=o(),q=async()=>{try{i.value=!0;const a=await e();a.data&&a.data.data&&(n.value=Array.isArray(a.data.data)?a.data.data:[])}catch(a){d.error("获取菜单列表失败"),n.value=[]}finally{i.value=!1}},O=()=>{y.value="新增菜单",h.value=!0},G=async()=>{if(g.value){await g.value.validate();try{if(b.value=!0,V.value.id){const e={name:V.value.name,icon:V.value.icon,sort:V.value.sort};await l(V.value.id,e),d.success("更新成功"),await A.getUserInfoAction()}else await t(V.value),d.success("创建成功"),await A.getUserInfoAction();h.value=!1,q()}catch(e){}finally{b.value=!1}}},H=()=>{g.value&&g.value.resetFields(),V.value={name:"",path:"",icon:"",sort:0,parent_id:null}};return w((()=>{q()})),(e,l)=>{const t=s("el-button"),o=s("el-table-column"),u=s("el-table"),k=s("el-tree-select"),w=s("el-form-item"),J=s("el-input"),K=s("el-input-number"),L=s("el-form"),M=s("el-dialog"),P=x("loading");return p(),_("div",E,[f("div",F,[v(t,{type:"primary",onClick:O},{default:m((()=>l[7]||(l[7]=[C("新增菜单")]))),_:1})]),U((p(),c(u,{data:n.value,style:{width:"100%"},"row-key":"id","tree-props":{children:"children"}},{default:m((()=>[v(o,{prop:"name",label:"菜单名称"}),v(o,{prop:"path",label:"路由路径"}),v(o,{prop:"icon",label:"图标"}),v(o,{prop:"sort",label:"排序",width:"80"}),v(o,{label:"操作",width:"200",fixed:"right"},{default:m((({row:e})=>[v(t,{type:"primary",link:"",onClick:a=>(e=>{y.value="编辑菜单",V.value={...e},h.value=!0})(e)},{default:m((()=>l[8]||(l[8]=[C("编辑")]))),_:2},1032,["onClick"]),v(t,{type:"danger",link:"",onClick:l=>(async e=>{try{await r.confirm("确认删除该菜单吗？","提示",{type:"warning"}),await a(e.id),d.success("删除成功"),await A.getUserInfoAction(),q()}catch(l){}})(e)},{default:m((()=>l[9]||(l[9]=[C("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[P,i.value]]),v(M,{title:y.value,modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=e=>h.value=e),width:"500px",onClose:H},{footer:m((()=>[v(t,{onClick:l[5]||(l[5]=e=>h.value=!1)},{default:m((()=>l[10]||(l[10]=[C("取消")]))),_:1}),v(t,{type:"primary",onClick:G,loading:b.value},{default:m((()=>l[11]||(l[11]=[C(" 确定 ")]))),_:1},8,["loading"])])),default:m((()=>[v(L,{ref_key:"formRef",ref:g,model:V.value,rules:j,"label-width":"80px"},{default:m((()=>[V.value.id?I("",!0):(p(),c(w,{key:0,label:"上级菜单"},{default:m((()=>[v(k,{modelValue:V.value.parent_id,"onUpdate:modelValue":l[0]||(l[0]=e=>V.value.parent_id=e),data:n.value,props:{label:"name",value:"id",children:"children"},placeholder:"请选择上级菜单",clearable:""},null,8,["modelValue","data"])])),_:1})),v(w,{label:"菜单名称",prop:"name"},{default:m((()=>[v(J,{modelValue:V.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>V.value.name=e),placeholder:"请输入菜单名称"},null,8,["modelValue"])])),_:1}),v(w,{label:"路由路径",prop:"path"},{default:m((()=>[v(J,{modelValue:V.value.path,"onUpdate:modelValue":l[2]||(l[2]=e=>V.value.path=e),placeholder:"请输入路由路径",disabled:!!V.value.id},null,8,["modelValue","disabled"])])),_:1}),v(w,{label:"图标",prop:"icon"},{default:m((()=>[v(z,{modelValue:V.value.icon,"onUpdate:modelValue":l[3]||(l[3]=e=>V.value.icon=e)},null,8,["modelValue"])])),_:1}),v(w,{label:"排序",prop:"sort"},{default:m((()=>[v(K,{modelValue:V.value.sort,"onUpdate:modelValue":l[4]||(l[4]=e=>V.value.sort=e),min:0,max:99},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-226fcdd4"]]);export{G as default};
