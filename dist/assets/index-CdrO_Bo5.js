import{x as e,aA as a,r as l,ag as s,y as r,z as t,P as o,H as u,A as d,u as n,L as i}from"./vendor-BVd4RN3d.js";import{E as p,u as m,l as f}from"./element-plus-CCDyQ1z5.js";import{u as c,l as _}from"./index-CFSbY6bd.js";import{_ as v}from"./_plugin-vue_export-helper-BCo6x5W8.js";const g={class:"login-container"},w=v(e({__name:"index",setup(e){const v=a(),w=c(),y=l(),h=l(!1),x=l({username:"",password:""}),V={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},k=async()=>{if(y.value){await y.value.validate();try{h.value=!0;const{data:e}=await _(x.value),a=e.data,{token:l,refreshToken:s,expires:r,userInfo:t}=a;w.setToken(l,s,r),w.setUserInfo({...t,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}),p.success("登录成功"),v.push("/dashboard")}catch(e){}finally{h.value=!1}}};return(e,a)=>{const l=s("el-icon"),p=s("el-input"),c=s("el-form-item"),_=s("el-button"),v=s("el-form");return r(),t("div",g,[o(v,{ref_key:"formRef",ref:y,model:x.value,rules:V,class:"login-form"},{default:u((()=>[a[3]||(a[3]=d("h3",{class:"title"},"文知管理系统",-1)),o(c,{prop:"username"},{default:u((()=>[o(p,{modelValue:x.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.username=e),placeholder:"用户名",type:"text"},{prefix:u((()=>[o(l,null,{default:u((()=>[o(n(m))])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(c,{prop:"password"},{default:u((()=>[o(p,{modelValue:x.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.password=e),placeholder:"密码",type:"password"},{prefix:u((()=>[o(l,null,{default:u((()=>[o(n(f))])),_:1})])),_:1},8,["modelValue"])])),_:1}),o(c,null,{default:u((()=>[o(_,{loading:h.value,type:"primary",style:{width:"100%"},onClick:k},{default:u((()=>a[2]||(a[2]=[i(" 登录 ")]))),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])}}}),[["__scopeId","data-v-0f892f6e"]]);export{w as default};
