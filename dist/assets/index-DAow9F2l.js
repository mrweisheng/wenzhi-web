import{g as O,d as G,u as H,c as J}from"./menu-DPOIiJzM.js";import{d as q,af as K,b as s,o as m,s as C,w as a,e as t,f as I,c as M,q as P,g as Q,F as W,aq as $,z as X,x as Y,r as p,a as Z,n as ee,I as le,h as w,p as te,t as ae,E as x,A as oe}from"./index-4kIbEQav.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"icon-list"},se=["onClick"],re={class:"icon-name"},ue=q({__name:"index",props:{modelValue:{}},emits:["update:modelValue"],setup(A,{emit:f}){const v=A,u=f,r=K({get:()=>v.modelValue,set:i=>u("update:modelValue",i)}),g=Object.keys($),c=i=>$[i],l=i=>{r.value=i};return(i,_)=>{const b=s("el-input"),h=s("el-icon"),U=s("el-popover");return m(),C(U,{placement:"bottom",width:300,trigger:"click","popper-class":"icon-select-popover"},{reference:a(()=>[t(b,{modelValue:r.value,"onUpdate:modelValue":_[0]||(_[0]=d=>r.value=d),placeholder:"点击选择图标",readonly:"","suffix-icon":r.value?c(r.value):""},null,8,["modelValue","suffix-icon"])]),default:a(()=>[I("div",ne,[(m(!0),M(W,null,P(Q(g),d=>(m(),M("div",{key:d,class:"icon-item",onClick:D=>l(d)},[t(h,null,{default:a(()=>[(m(),C(X(d)))]),_:2},1024),I("span",re,Y(d),1)],8,se))),128))])]),_:1})}}}),ie=B(ue,[["__scopeId","data-v-e5a85411"]]),de={class:"app-container"},ce={class:"toolbar"},pe=q({__name:"index",setup(A){const f=p(!1),v=p([]),u=p(!1),r=p(""),g=p(!1),c=p(),l=p({name:"",path:"",icon:"",sort:0,parent_id:null}),i={name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],icon:[{required:!0,message:"请输入图标名称",trigger:"blur"}]},_=Z(),b=async()=>{try{f.value=!0;const o=await O();o.data&&o.data.data&&(v.value=Array.isArray(o.data.data)?o.data.data:[])}catch(o){console.error("获取菜单列表失败:",o),x.error("获取菜单列表失败"),v.value=[]}finally{f.value=!1}},h=()=>{r.value="新增菜单",u.value=!0},U=o=>{r.value="编辑菜单",l.value={...o},u.value=!0},d=async o=>{try{await oe.confirm("确认删除该菜单吗？","提示",{type:"warning"}),await G(o.id),x.success("删除成功"),await _.getUserInfoAction(),b()}catch(e){console.error("Delete menu error:",e)}},D=async()=>{if(c.value){await c.value.validate();try{if(g.value=!0,l.value.id){const o={name:l.value.name,icon:l.value.icon,sort:l.value.sort};await H(l.value.id,o),x.success("更新成功"),await _.getUserInfoAction()}else await J(l.value),x.success("创建成功"),await _.getUserInfoAction();u.value=!1,b()}catch(o){console.error("Submit menu error:",o)}finally{g.value=!1}}},E=()=>{c.value&&c.value.resetFields(),l.value={name:"",path:"",icon:"",sort:0,parent_id:null}};return ee(()=>{b()}),(o,e)=>{const V=s("el-button"),y=s("el-table-column"),F=s("el-table"),L=s("el-tree-select"),k=s("el-form-item"),S=s("el-input"),N=s("el-input-number"),R=s("el-form"),T=s("el-dialog"),j=le("loading");return m(),M("div",de,[I("div",ce,[t(V,{type:"primary",onClick:h},{default:a(()=>e[7]||(e[7]=[w("新增菜单")])),_:1})]),te((m(),C(F,{data:v.value,style:{width:"100%"},"row-key":"id","tree-props":{children:"children"}},{default:a(()=>[t(y,{prop:"name",label:"菜单名称"}),t(y,{prop:"path",label:"路由路径"}),t(y,{prop:"icon",label:"图标"}),t(y,{prop:"sort",label:"排序",width:"80"}),t(y,{label:"操作",width:"200",fixed:"right"},{default:a(({row:n})=>[t(V,{type:"primary",link:"",onClick:z=>U(n)},{default:a(()=>e[8]||(e[8]=[w("编辑")])),_:2},1032,["onClick"]),t(V,{type:"danger",link:"",onClick:z=>d(n)},{default:a(()=>e[9]||(e[9]=[w("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[j,f.value]]),t(T,{title:r.value,modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value=n),width:"500px",onClose:E},{footer:a(()=>[t(V,{onClick:e[5]||(e[5]=n=>u.value=!1)},{default:a(()=>e[10]||(e[10]=[w("取消")])),_:1}),t(V,{type:"primary",onClick:D,loading:g.value},{default:a(()=>e[11]||(e[11]=[w(" 确定 ")])),_:1},8,["loading"])]),default:a(()=>[t(R,{ref_key:"formRef",ref:c,model:l.value,rules:i,"label-width":"80px"},{default:a(()=>[l.value.id?ae("",!0):(m(),C(k,{key:0,label:"上级菜单"},{default:a(()=>[t(L,{modelValue:l.value.parent_id,"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.parent_id=n),data:v.value,props:{label:"name",value:"id",children:"children"},placeholder:"请选择上级菜单",clearable:""},null,8,["modelValue","data"])]),_:1})),t(k,{label:"菜单名称",prop:"name"},{default:a(()=>[t(S,{modelValue:l.value.name,"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.name=n),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),t(k,{label:"路由路径",prop:"path"},{default:a(()=>[t(S,{modelValue:l.value.path,"onUpdate:modelValue":e[2]||(e[2]=n=>l.value.path=n),placeholder:"请输入路由路径",disabled:!!l.value.id},null,8,["modelValue","disabled"])]),_:1}),t(k,{label:"图标",prop:"icon"},{default:a(()=>[t(ie,{modelValue:l.value.icon,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value.icon=n)},null,8,["modelValue"])]),_:1}),t(k,{label:"排序",prop:"sort"},{default:a(()=>[t(N,{modelValue:l.value.sort,"onUpdate:modelValue":e[4]||(e[4]=n=>l.value.sort=n),min:0,max:99},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),fe=B(pe,[["__scopeId","data-v-226fcdd4"]]);export{fe as default};
//# sourceMappingURL=index-DAow9F2l.js.map
