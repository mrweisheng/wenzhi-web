{"version":3,"file":"index-CQph0KJy.js","sources":["../../src/api/cases.ts","../../src/views/cases/index.vue"],"sourcesContent":["import request from '@/utils/request'\r\nimport type { ApiResponse } from '@/types/response'\r\n\r\n// 获取案例列表\r\nexport function getCaseList(params?: {\r\n  keyword?: string\r\n  case_type?: string\r\n  page?: number\r\n  pageSize?: number\r\n}) {\r\n  return request<ApiResponse>({\r\n    url: '/api/cases',\r\n    method: 'get',\r\n    params\r\n  })\r\n}\r\n\r\n// 获取案例详情\r\nexport function getCaseDetail(id: string) {\r\n  return request<ApiResponse>({\r\n    url: `/api/cases/${id}`,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\n// 创建案例 - 支持多图片上传\r\nexport function createCase(data: FormData) {\r\n  return request<ApiResponse>({\r\n    url: '/api/cases',\r\n    method: 'post',\r\n    data,\r\n    headers: {\r\n      'Content-Type': 'multipart/form-data'\r\n    }\r\n  })\r\n}\r\n\r\n// 归档案例\r\nexport function archiveCase(id: string) {\r\n  return request<ApiResponse>({\r\n    url: `/api/cases/${id}/archive`,\r\n    method: 'put'\r\n  })\r\n}\r\n\r\n// 删除案例\r\nexport function deleteCase(id: string) {\r\n  return request<ApiResponse>({\r\n    url: `/api/cases/${id}`,\r\n    method: 'delete'\r\n  })\r\n} ","<template>\r\n  <div class=\"app-container\">\r\n    <!-- 头部搜索区域 -->\r\n    <div class=\"search-area bg-white rounded-lg p-4\">\r\n      <div class=\"search-row\">\r\n        <el-input\r\n          v-model=\"searchQuery\"\r\n          placeholder=\"搜索案例...\"\r\n          class=\"search-input\"\r\n          size=\"large\"\r\n          @keyup.enter=\"handleSearch\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"text-gray-400\"><Search /></el-icon>\r\n          </template>\r\n        </el-input>\r\n        <el-select v-model=\"caseTypeFilter\" placeholder=\"所有案例类型\" class=\"filter-select\" size=\"large\" @change=\"handleSearch\">\r\n          <el-option label=\"所有类型\" value=\"\" />\r\n          <el-option label=\"聊天话术\" value=\"chatScript\" />\r\n          <el-option label=\"聊天反馈\" value=\"chatFeedback\" />\r\n          <el-option label=\"谈单成功\" value=\"dealSuccess\" />\r\n          <el-option label=\"谈单失败\" value=\"dealFailure\" />\r\n        </el-select>\r\n        <el-button type=\"primary\" @click=\"handleCreateCase\" class=\"create-button\" size=\"large\">\r\n          新建案例\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 加载中 -->\r\n    <div v-if=\"loading\" class=\"flex justify-center items-center py-12\">\r\n      <el-icon class=\"is-loading\"><Loading /></el-icon>\r\n    </div>\r\n\r\n    <!-- 案例列表为空 -->\r\n    <div v-else-if=\"cases.length === 0\" class=\"flex flex-col justify-center items-center py-20\">\r\n      <el-empty description=\"暂无案例\" />\r\n      <el-button type=\"primary\" @click=\"handleCreateCase\" class=\"mt-4\">新建案例</el-button>\r\n    </div>\r\n\r\n    <!-- 案例列表 -->\r\n    <div v-else class=\"case-grid\">\r\n      <div\r\n        v-for=\"item in cases\"\r\n        :key=\"item.id\"\r\n        class=\"case-card bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300\"\r\n      >\r\n        <!-- 删除按钮 - 仅有删除权限的用户可见 -->\r\n        <div v-if=\"hasDeletePermission\" class=\"delete-button\" @click.stop=\"confirmDelete(item)\">\r\n          <el-tooltip content=\"删除案例\" placement=\"top\">\r\n            <el-icon><Delete /></el-icon>\r\n          </el-tooltip>\r\n        </div>\r\n        \r\n        <!-- 图片预览区域 -->\r\n        <div class=\"case-card-image-wrapper\" @click=\"openDrawer(item)\">\r\n          <img v-if=\"item.images && item.images.length > 0\" \r\n              :src=\"item.images[0]\" \r\n              class=\"case-card-image\" \r\n              alt=\"案例图片\"\r\n          />\r\n          <div v-else class=\"no-image\">\r\n            <el-icon><Picture /></el-icon>\r\n            <span>暂无图片</span>\r\n          </div>\r\n          <div v-if=\"item.images && item.images.length > 1\" class=\"image-count\">\r\n            <el-icon><Picture /></el-icon>\r\n            <span>{{ item.images.length }}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"case-card-content\" @click=\"openDrawer(item)\">\r\n          <!-- 案例编号和标题 -->\r\n          <div class=\"case-card-header\">\r\n            <div class=\"flex justify-between items-center mb-2\">\r\n              <span class=\"case-id\">#{{ item.id }}</span>\r\n              <el-tag\r\n                :type=\"getStatusType(item.status)\"\r\n                effect=\"light\"\r\n                size=\"small\"\r\n                class=\"status-tag\"\r\n              >\r\n                {{ getStatusLabel(item.status) }}\r\n              </el-tag>\r\n            </div>\r\n            <h3 class=\"case-card-title\">{{ item.title }}</h3>\r\n            <!-- 标签组 -->\r\n            <div class=\"tags-group\">\r\n              <el-tag\r\n                :type=\"getCaseTypeType(item.case_type)\"\r\n                effect=\"light\"\r\n                class=\"category-tag\"\r\n              >\r\n                {{ getCaseTypeLabel(item.case_type) }}\r\n              </el-tag>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- 时间显示区域 -->\r\n          <div class=\"time-section mb-4\">\r\n            <div class=\"time-tag archive-time\">\r\n              <el-icon class=\"mr-1\"><Clock /></el-icon>\r\n              <span>{{ item.status === 'archived' ? `归档: ${formatDate(item.archiveTime)}` : '待归档' }}</span>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- 简介内容 -->\r\n          <div class=\"description-section mb-4\">\r\n            <p class=\"description-text\">{{ truncateText(item.description, 100) }}</p>\r\n          </div>\r\n          \r\n          <!-- 用户信息区域 - 归档人 -->\r\n          <div class=\"users-section\">\r\n            <div class=\"users-row\">\r\n              <div class=\"user-cell\">\r\n                <span class=\"user-label\">归档人:</span>\r\n                <div class=\"user-info\">\r\n                  <el-avatar :size=\"24\" \r\n                    :src=\"getAvatarUrl(item.archiver ? item.archiver.name : (item.creator ? item.creator.name : '未知用户'))\" \r\n                    class=\"user-avatar\" />\r\n                  <span class=\"user-name\">\r\n                    {{ item.archiver ? item.archiver.name : (item.status === 'archived' ? '未知' : '待定') }}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 详情抽屉 -->\r\n    <el-drawer\r\n      v-model=\"drawerVisible\"\r\n      :title=\"currentCase?.title || '案例详情'\"\r\n      size=\"60%\"\r\n      :destroy-on-close=\"true\"\r\n    >\r\n      <template #header>\r\n        <div v-if=\"currentCase\" class=\"flex items-center justify-between w-full\">\r\n          <h2 class=\"text-2xl font-bold\">{{ currentCase.title }}</h2>\r\n          <div v-if=\"hasDeletePermission\" class=\"drawer-actions\">\r\n            <el-button \r\n              type=\"danger\" \r\n              size=\"small\" \r\n              plain \r\n              @click.stop=\"confirmDelete(currentCase)\"\r\n              :loading=\"deleting\"\r\n            >\r\n              <el-icon class=\"mr-1\"><Delete /></el-icon>\r\n              删除案例\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n        <div v-else class=\"flex items-center space-x-4\">\r\n          <h2 class=\"text-2xl font-bold\">加载中...</h2>\r\n        </div>\r\n      </template>\r\n\r\n      <!-- 加载中 -->\r\n      <div v-if=\"loadingDetail\" class=\"flex justify-center items-center py-12\">\r\n        <el-icon class=\"is-loading\"><Loading /></el-icon>\r\n      </div>\r\n\r\n      <div v-else-if=\"currentCase\" class=\"case-detail p-6\">\r\n        <!-- 图片轮播区域 -->\r\n        <div class=\"carousel-container\" v-if=\"currentCase.images && currentCase.images.length > 0\">\r\n          <el-carousel height=\"400px\" indicator-position=\"outside\" :interval=\"4000\" arrow=\"always\" type=\"card\">\r\n            <el-carousel-item v-for=\"(image, index) in currentCase.images\" :key=\"index\" @click=\"openImageViewer(index)\">\r\n              <div class=\"carousel-image-container\">\r\n                <img :src=\"image\" class=\"carousel-image\" :alt=\"`案例图片${index + 1}`\">\r\n                <div class=\"image-overlay\">\r\n                  <el-icon><ZoomIn /></el-icon>\r\n                  <span>点击查看大图</span>\r\n                </div>\r\n              </div>\r\n            </el-carousel-item>\r\n          </el-carousel>\r\n        </div>\r\n\r\n        <!-- 图片查看器 - 查看大图 -->\r\n        <div \r\n          class=\"image-viewer-container\" \r\n          v-if=\"imageViewerVisible\" \r\n          @click=\"closeImageViewer\" \r\n          tabindex=\"0\" \r\n          ref=\"imageViewerRef\"\r\n          @touchstart=\"handleTouchStart\"\r\n          @touchmove=\"handleTouchMove\"\r\n          @touchend=\"handleTouchEnd\"\r\n        >\r\n          <div class=\"image-viewer-content\" @click.stop>\r\n            <div class=\"image-viewer-header\">\r\n              <span class=\"image-counter\">{{ currentImageIndex + 1 }} / {{ currentCase?.images?.length }}</span>\r\n              <div class=\"image-actions\">\r\n                <el-tooltip content=\"放大 (+)\" placement=\"bottom\">\r\n                  <el-button circle plain size=\"small\" @click=\"zoomIn\">\r\n                    <el-icon><ZoomIn /></el-icon>\r\n                  </el-button>\r\n                </el-tooltip>\r\n                <el-tooltip content=\"缩小 (-)\" placement=\"bottom\">\r\n                  <el-button circle plain size=\"small\" @click=\"zoomOut\">\r\n                    <el-icon><ZoomOut /></el-icon>\r\n                  </el-button>\r\n                </el-tooltip>\r\n                <el-tooltip content=\"旋转 (R)\" placement=\"bottom\">\r\n                  <el-button circle plain size=\"small\" @click=\"rotateImage\">\r\n                    <el-icon><RefreshRight /></el-icon>\r\n                  </el-button>\r\n                </el-tooltip>\r\n                <el-tooltip content=\"下载图片\" placement=\"bottom\">\r\n                  <el-button circle plain size=\"small\" @click=\"downloadImage\">\r\n                    <el-icon><Download /></el-icon>\r\n                  </el-button>\r\n                </el-tooltip>\r\n                <el-tooltip content=\"关闭 (ESC)\" placement=\"bottom\">\r\n                  <el-button circle plain size=\"small\" @click=\"closeImageViewer\">\r\n                    <el-icon><Close /></el-icon>\r\n                  </el-button>\r\n                </el-tooltip>\r\n              </div>\r\n            </div>\r\n            <div class=\"image-viewer-body\">\r\n              <el-button @click.stop=\"prevImage\" circle plain class=\"nav-button prev-button\" :disabled=\"currentImageIndex === 0\">\r\n                <el-icon><ArrowLeft /></el-icon>\r\n              </el-button>\r\n              \r\n              <div class=\"image-container\">\r\n                <div v-if=\"imageLoading\" class=\"image-loading\">\r\n                  <el-icon class=\"loading-icon\"><Loading /></el-icon>\r\n                  <span>加载中...</span>\r\n                </div>\r\n                <img \r\n                  :src=\"currentImageUrl\" \r\n                  alt=\"大图预览\" \r\n                  class=\"preview-image\" \r\n                  :style=\"{ transform: `scale(${zoomLevel}) rotate(${rotation}deg)` }\"\r\n                  @wheel=\"handleMouseWheel\"\r\n                  @load=\"handleImageLoad\"\r\n                >\r\n              </div>\r\n              \r\n              <el-button @click.stop=\"nextImage\" circle plain class=\"nav-button next-button\" :disabled=\"currentImageIndex === (currentCase?.images?.length || 0) - 1\">\r\n                <el-icon><ArrowRight /></el-icon>\r\n              </el-button>\r\n            </div>\r\n            \r\n            <div class=\"keyboard-tips\">\r\n              键盘快捷键: ← 上一张 | → 下一张 | + 放大 | - 缩小 | R 旋转 | ESC 关闭\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 案例描述区域 -->\r\n        <div class=\"info-card bg-white rounded-lg shadow-sm mb-6\">\r\n          <div class=\"card-header py-4 px-6 border-b border-gray-200\">\r\n            <h3 class=\"section-title\">案例描述</h3>\r\n          </div>\r\n          <div class=\"card-body p-6\">\r\n            <div class=\"content-wrapper px-4\">\r\n              <p class=\"description-content whitespace-pre-line\">\r\n                {{ currentCase.description }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 基本信息区域 -->\r\n        <div class=\"info-card bg-white rounded-lg shadow-sm mb-6\">\r\n          <!-- 标题 -->\r\n          <div class=\"card-header py-4 px-6 border-b border-gray-200\">\r\n            <h3 class=\"section-title\">基本信息</h3>\r\n          </div>\r\n          \r\n          <!-- 内容区域 -->\r\n          <div class=\"card-body p-6\">\r\n            <div class=\"content-wrapper\">\r\n              <div class=\"basic-info-container\">\r\n                <!-- 案例编号 -->\r\n                <div class=\"basic-info-item\">\r\n                  <div class=\"info-icon-box\">\r\n                    <el-icon><Document /></el-icon>\r\n                  </div>\r\n                  <div class=\"info-content\">\r\n                    <div class=\"info-label\">案例编号</div>\r\n                    <div class=\"info-value\">\r\n                      <span class=\"case-number\">{{ currentCase.id }}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <!-- 案例类型 -->\r\n                <div class=\"basic-info-item\">\r\n                  <div class=\"info-icon-box\">\r\n                    <el-icon><Collection /></el-icon>\r\n                  </div>\r\n                  <div class=\"info-content\">\r\n                    <div class=\"info-label\">案例类型</div>\r\n                    <div class=\"info-value\">\r\n                      <el-tag\r\n                        :type=\"getCaseTypeType(currentCase.case_type)\"\r\n                        class=\"case-type-tag\"\r\n                      >\r\n                        {{ getCaseTypeLabel(currentCase.case_type) }}\r\n                      </el-tag>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <!-- 案例状态 -->\r\n                <div class=\"basic-info-item\">\r\n                  <div class=\"info-icon-box\">\r\n                    <el-icon><Flag /></el-icon>\r\n                  </div>\r\n                  <div class=\"info-content\">\r\n                    <div class=\"info-label\">归档状态</div>\r\n                    <div class=\"info-value\">\r\n                      <el-tag\r\n                        :type=\"getStatusType(currentCase.status)\"\r\n                        class=\"status-tag\"\r\n                      >\r\n                        {{ getStatusLabel(currentCase.status) }}\r\n                      </el-tag>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <!-- 创建时间 -->\r\n                <div class=\"basic-info-item\">\r\n                  <div class=\"info-icon-box\">\r\n                    <el-icon><Calendar /></el-icon>\r\n                  </div>\r\n                  <div class=\"info-content\">\r\n                    <div class=\"info-label\">创建时间</div>\r\n                    <div class=\"info-value\">\r\n                      {{ formatDate(currentCase.createTime) }}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <!-- 归档信息 - 横向布局 -->\r\n              <div class=\"archive-section mt-5\">\r\n                <div class=\"card-section-title mb-4\">归档信息</div>\r\n                <div class=\"archive-info-wrapper bg-gray-50 rounded-lg p-5\">\r\n                  <div class=\"archive-info-grid\">\r\n                    <!-- 归档时间 -->\r\n                    <div class=\"archive-info-item\">\r\n                      <div class=\"info-row\">\r\n                        <div class=\"info-icon-container\">\r\n                          <el-icon class=\"info-icon\"><Clock /></el-icon>\r\n                        </div>\r\n                        <div class=\"info-content\">\r\n                          <div class=\"info-label\">归档时间</div>\r\n                          <div class=\"info-value\">\r\n                            {{ currentCase.status === 'archived' ? formatDate(currentCase.archiveTime) : '待归档' }}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    <!-- 归档人 -->\r\n                    <div class=\"archive-info-item\">\r\n                      <div class=\"info-row\">\r\n                        <div class=\"info-icon-container\">\r\n                          <el-icon class=\"info-icon\"><User /></el-icon>\r\n                        </div>\r\n                        <div class=\"info-content\">\r\n                          <div class=\"info-label\">归档人</div>\r\n                          <div class=\"info-value user-value\">\r\n                            <el-avatar :size=\"24\" :src=\"getAvatarUrl(currentCase.archiver ? currentCase.archiver.name : (currentCase.creator?.name || '未知用户'))\" />\r\n                            <span>{{ currentCase.archiver ? currentCase.archiver.name : (currentCase.status === 'archived' ? '未知' : '待定') }}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </el-drawer>\r\n\r\n    <!-- 新建案例对话框 -->\r\n    <el-dialog\r\n      v-model=\"createDialogVisible\"\r\n      title=\"新建案例\"\r\n      width=\"700px\"\r\n      :destroy-on-close=\"true\"\r\n    >\r\n      <div class=\"create-form\">\r\n        <el-form :model=\"newCase\" label-position=\"top\" :rules=\"formRules\" ref=\"createFormRef\">\r\n          <el-form-item label=\"案例标题\" prop=\"title\">\r\n            <el-input v-model=\"newCase.title\" placeholder=\"请输入案例标题\"></el-input>\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"案例类型\" prop=\"case_type\">\r\n            <el-select v-model=\"newCase.case_type\" placeholder=\"请选择案例类型\" class=\"w-full\">\r\n              <el-option label=\"聊天话术\" value=\"chatScript\" />\r\n              <el-option label=\"聊天反馈\" value=\"chatFeedback\" />\r\n              <el-option label=\"谈单成功\" value=\"dealSuccess\" />\r\n              <el-option label=\"谈单失败\" value=\"dealFailure\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"案例描述\" prop=\"content\">\r\n            <el-input\r\n              v-model=\"newCase.content\"\r\n              type=\"textarea\"\r\n              :rows=\"6\"\r\n              placeholder=\"请输入案例描述\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          \r\n          <el-form-item label=\"上传图片（可选，最多10张，每张不超过2MB）\">\r\n            <el-upload\r\n              action=\"#\"\r\n              list-type=\"picture-card\"\r\n              :auto-upload=\"false\"\r\n              :limit=\"10\"\r\n              :file-list=\"fileList\"\r\n              :on-change=\"handleFileChange\"\r\n              :on-remove=\"handleFileRemove\"\r\n              :on-exceed=\"handleExceed\"\r\n              :before-upload=\"beforeUpload\"\r\n            >\r\n              <el-icon><Plus /></el-icon>\r\n              <template #file=\"{ file }\">\r\n                <div>\r\n                  <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\" />\r\n                  <div class=\"el-upload-list__item-actions\">\r\n                    <span \r\n                      class=\"el-upload-list__item-delete\" \r\n                      @click.stop=\"handleFileRemove(file)\"\r\n                    >\r\n                      <el-icon><Delete /></el-icon>\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </el-upload>\r\n            <div class=\"upload-tips text-sm text-gray-500 mt-2\">\r\n              <p>* 支持PNG、JPG、JPEG格式，每张图片大小不超过2MB</p>\r\n              <p>* 最多可上传10张图片</p>\r\n            </div>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n      \r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"createDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"submitNewCase\" :loading=\"submitting\">创建案例</el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, computed, onUnmounted, reactive } from 'vue'\r\nimport { Search, Calendar, Clock, Picture, Timer, Plus, Delete, Loading, MoreFilled, ZoomIn, Close, ArrowLeft, ArrowRight, ZoomOut, RefreshRight, Download, User, Document, Collection, Flag } from '@element-plus/icons-vue'\r\nimport { formatDate } from '@/utils/format'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { getCaseList, getCaseDetail, createCase, deleteCase } from '@/api/cases'\r\nimport { useUserStore } from '@/stores/user'\r\n\r\n// 用户权限角色\r\nconst userStore = useUserStore()\r\n// 模拟当前用户角色，实际应从userStore中获取\r\nconst currentUserRole = ref('admin') // 可能的值: 'admin', 'manager', 'service', 'inspector', 'user'\r\n\r\n// 判断是否有删除权限\r\nconst hasDeletePermission = computed(() => {\r\n  // 根据角色判断，超级管理员、主管、客服及质检人员可以删除\r\n  const role = currentUserRole.value\r\n  return ['admin', 'manager', 'service', 'inspector'].includes(role)\r\n})\r\n\r\n// 定义案例类型接口\r\ninterface Creator {\r\n  id: number\r\n  name: string\r\n}\r\n\r\ninterface Archiver {\r\n  id: number\r\n  name: string\r\n}\r\n\r\ninterface Case {\r\n  id: string\r\n  title: string\r\n  case_type: string\r\n  status: string  // 内部状态字段\r\n  content?: string  // API返回的内容字段\r\n  description: string  // 内部使用的描述字段\r\n  created_at?: string  // API返回的创建时间\r\n  updated_at?: string  // API返回的更新时间\r\n  createTime: string  // 内部使用的创建时间\r\n  archiveTime?: string  // 内部使用的归档时间\r\n  creator: Creator\r\n  archiver?: Archiver  // 内部使用的归档人\r\n  images?: string[]\r\n}\r\n\r\n// 数据加载状态\r\nconst loading = ref(false)\r\nconst loadingDetail = ref(false)\r\n\r\n// 抽屉控制\r\nconst drawerVisible = ref(false)\r\nconst currentCase = ref<Case | null>(null)\r\n\r\n// 搜索和筛选\r\nconst searchQuery = ref('')\r\nconst caseTypeFilter = ref('')\r\n\r\n// 案例列表\r\nconst cases = ref<Case[]>([])\r\n\r\n// 获取案例类型标签样式\r\nconst getCaseTypeType = (case_type: string) => {\r\n  const typeMap: Record<string, string> = {\r\n    chatScript: 'info',\r\n    chatFeedback: 'warning',\r\n    dealSuccess: 'success',\r\n    dealFailure: 'danger'\r\n  }\r\n  return typeMap[case_type] || 'info'\r\n}\r\n\r\n// 获取案例类型标签文本\r\nconst getCaseTypeLabel = (case_type: string) => {\r\n  const labelMap: Record<string, string> = {\r\n    chatScript: '聊天话术',\r\n    chatFeedback: '聊天反馈',\r\n    dealSuccess: '谈单成功',\r\n    dealFailure: '谈单失败'\r\n  }\r\n  return labelMap[case_type] || case_type\r\n}\r\n\r\n// 获取状态标签类型\r\nconst getStatusType = (status: string) => {\r\n  const typeMap: Record<string, string> = {\r\n    draft: 'info',\r\n    inProcess: 'warning',\r\n    archived: 'success'\r\n  }\r\n  return typeMap[status] || 'info'\r\n}\r\n\r\n// 获取状态标签文本\r\nconst getStatusLabel = (status: string) => {\r\n  const labelMap: Record<string, string> = {\r\n    draft: '草稿',\r\n    inProcess: '处理中',\r\n    archived: '已归档'\r\n  }\r\n  return labelMap[status] || status\r\n}\r\n\r\n// 截断文本\r\nconst truncateText = (text: string, maxLength: number) => {\r\n  if (!text) return ''\r\n  if (text.length <= maxLength) return text\r\n  return text.substring(0, maxLength) + '...'\r\n}\r\n\r\n// 获取用户头像URL\r\nconst getAvatarUrl = (name?: string) => {\r\n  return `https://api.dicebear.com/7.x/avataaars/svg?seed=${encodeURIComponent(name || '未知用户')}`\r\n}\r\n\r\n// 搜索处理\r\nconst handleSearch = () => {\r\n  // 这里只是示例，实际应该调用API获取数据\r\n  loading.value = true\r\n  setTimeout(() => {\r\n    loading.value = false\r\n  }, 500)\r\n}\r\n\r\n// 打开详情抽屉\r\nconst openDrawer = (item: Case) => {\r\n  currentCase.value = null\r\n  drawerVisible.value = true\r\n  loadingDetail.value = true\r\n  \r\n  // 调用API获取详情\r\n  getCaseDetail(item.id)\r\n    .then(res => {\r\n      if (res.data.code === 0 && res.data.data) {\r\n        const detailData = res.data.data\r\n        // 映射API返回的数据到内部使用的数据结构\r\n        currentCase.value = {\r\n          id: detailData.id,\r\n          title: detailData.title,\r\n          case_type: detailData.case_type,\r\n          status: 'archived', // API没有返回status字段，默认为已归档\r\n          content: detailData.content,\r\n          description: detailData.content,\r\n          created_at: detailData.created_at,\r\n          updated_at: detailData.updated_at,\r\n          createTime: detailData.created_at,\r\n          archiveTime: detailData.updated_at,\r\n          creator: detailData.creator,\r\n          archiver: detailData.creator, // API没有返回归档人，使用创建人代替\r\n          images: detailData.images || []\r\n        }\r\n      } else {\r\n        ElMessage.error(res.data.message || '获取案例详情失败')\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('获取案例详情失败:', error)\r\n      ElMessage.error('获取案例详情失败')\r\n    })\r\n    .finally(() => {\r\n      loadingDetail.value = false\r\n    })\r\n}\r\n\r\n// 新建案例\r\nconst handleCreateCase = () => {\r\n  createDialogVisible.value = true\r\n}\r\n\r\n// 新建案例对话框\r\nconst createDialogVisible = ref(false)\r\nconst newCase = ref({\r\n  title: '',\r\n  case_type: 'chatScript',\r\n  content: ''\r\n})\r\nconst formRules = ref({\r\n  title: [{ required: true, message: '请输入案例标题', trigger: 'blur' }],\r\n  case_type: [{ required: true, message: '请选择案例类型', trigger: 'change' }],\r\n  content: [{ required: true, message: '请输入案例描述', trigger: 'blur' }]\r\n})\r\nconst createFormRef = ref(null)\r\nconst fileList = ref([])\r\nconst submitting = ref(false)\r\n\r\n// 文件上传处理函数\r\nconst handleFileChange = (uploadFile: any) => {\r\n  // 生成缩略图预览\r\n  const reader = new FileReader()\r\n  reader.readAsDataURL(uploadFile.raw)\r\n  reader.onload = () => {\r\n    uploadFile.url = reader.result\r\n  }\r\n  \r\n  // 添加到文件列表\r\n  const isExist = fileList.value.some(item => item.uid === uploadFile.uid)\r\n  if (!isExist) {\r\n    fileList.value.push(uploadFile)\r\n  }\r\n}\r\n\r\nconst handleFileRemove = (file: any) => {\r\n  // 从文件列表中移除\r\n  fileList.value = fileList.value.filter(item => item.uid !== file.uid)\r\n}\r\n\r\nconst handleExceed = () => {\r\n  ElMessage.warning('最多只能上传10张图片!')\r\n}\r\n\r\nconst beforeUpload = (file: any) => {\r\n  // 检查文件类型\r\n  const isImage = ['image/jpeg', 'image/png', 'image/jpg'].includes(file.type)\r\n  if (!isImage) {\r\n    ElMessage.error('只能上传JPG/PNG格式的图片!')\r\n    return false\r\n  }\r\n  \r\n  // 检查文件大小\r\n  const isLt2M = file.size / 1024 / 1024 < 2\r\n  if (!isLt2M) {\r\n    ElMessage.error('图片大小不能超过2MB!')\r\n    return false\r\n  }\r\n  \r\n  return true\r\n}\r\n\r\nconst submitNewCase = () => {\r\n  if (!createFormRef.value) return\r\n  \r\n  createFormRef.value.validate(async (valid: boolean) => {\r\n    if (valid) {\r\n      // 准备FormData\r\n      const formData = new FormData()\r\n      formData.append('title', newCase.value.title)\r\n      formData.append('case_type', newCase.value.case_type)\r\n      formData.append('content', newCase.value.content)\r\n      \r\n      // 添加图片文件\r\n      if (fileList.value.length > 0) {\r\n        fileList.value.forEach((file: any) => {\r\n          formData.append('images', file.raw)\r\n        })\r\n      }\r\n      \r\n      submitting.value = true\r\n      try {\r\n        const res = await createCase(formData)\r\n        if (res.data.code === 0) {\r\n          ElMessage.success('案例创建成功')\r\n          createDialogVisible.value = false\r\n          // 重新加载案例列表\r\n          fetchCases()\r\n          // 重置表单\r\n          resetForm()\r\n        } else {\r\n          ElMessage.error(res.data.message || '创建失败')\r\n        }\r\n      } catch (error: any) {\r\n        console.error('创建案例失败:', error)\r\n        ElMessage.error(error.message || '提交失败，请重试')\r\n      } finally {\r\n        submitting.value = false\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  if (createFormRef.value) {\r\n    createFormRef.value.resetFields()\r\n  }\r\n  fileList.value = []\r\n  newCase.value = {\r\n    title: '',\r\n    case_type: 'chatScript',\r\n    content: ''\r\n  }\r\n}\r\n\r\n// 获取案例列表数据\r\nconst fetchCases = async () => {\r\n  loading.value = true\r\n  try {\r\n    const res = await getCaseList({\r\n      case_type: caseTypeFilter.value,\r\n      keyword: searchQuery.value,\r\n      page: 1,\r\n      pageSize: 20\r\n    })\r\n    if (res.data.code === 0) {\r\n      // 处理API返回的数据，确保必要字段存在\r\n      cases.value = (res.data.data?.list || []).map((item: any) => ({\r\n        ...item,\r\n        // 确保基本字段存在并进行字段映射\r\n        id: item.id || `CASE-${Math.floor(Math.random() * 10000)}`,\r\n        title: item.title || '无标题案例',\r\n        case_type: item.case_type || 'chatScript',\r\n        // 状态默认为已归档（因为API没有返回status字段）\r\n        status: 'archived',\r\n        // 字段名称映射\r\n        description: item.content || '无描述信息',\r\n        createTime: item.created_at || new Date().toISOString(),\r\n        // 设置归档时间为创建时间（因为API没有返回归档时间）\r\n        archiveTime: item.updated_at || item.created_at,\r\n        // 确保creator对象存在\r\n        creator: item.creator || { id: 0, name: '未知用户' },\r\n        // archiver是可选的，API没有返回，设为创建者\r\n        archiver: item.creator || null,\r\n        // images是可选的\r\n        images: Array.isArray(item.images) ? item.images : []\r\n      }))\r\n    } else {\r\n      ElMessage.error(res.data.message || '获取案例列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取案例列表失败:', error)\r\n    ElMessage.error('获取案例列表失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 页面加载时获取数据\r\nonMounted(() => {\r\n  // 获取用户角色信息（实际项目中应从userStore获取）\r\n  if (userStore.userInfo?.role?.role_name) {\r\n    currentUserRole.value = userStore.userInfo.role.role_name\r\n  }\r\n  // 加载案例列表\r\n  fetchCases()\r\n})\r\n\r\n// 确认删除\r\nconst deleting = ref(false)\r\nconst confirmDelete = (item: Case) => {\r\n  ElMessageBox.confirm(\r\n    `确定要删除案例\"${item.title}\"吗？删除后将无法恢复。`,\r\n    '删除确认',\r\n    {\r\n      confirmButtonText: '确定删除',\r\n      cancelButtonText: '取消',\r\n      type: 'warning',\r\n    }\r\n  )\r\n    .then(() => {\r\n      handleDeleteCase(item.id)\r\n    })\r\n    .catch(() => {\r\n      // 用户取消删除操作\r\n    })\r\n}\r\n\r\n// 删除案例\r\nconst handleDeleteCase = async (id: string) => {\r\n  deleting.value = true\r\n  try {\r\n    const res = await deleteCase(id)\r\n    if (res.data.code === 0) {\r\n      ElMessage.success('删除成功')\r\n      // 从列表中移除已删除的案例\r\n      cases.value = cases.value.filter(item => item.id !== id)\r\n    } else {\r\n      ElMessage.error(res.data.message || '删除失败')\r\n    }\r\n  } catch (error: any) {\r\n    console.error('删除案例失败:', error)\r\n    ElMessage.error(error.message || '删除失败，请重试')\r\n  } finally {\r\n    deleting.value = false\r\n  }\r\n}\r\n\r\n// 图片查看器控制\r\nconst imageViewerVisible = ref(false)\r\nconst currentImageIndex = ref(0)\r\nconst currentImageUrl = ref('')\r\nconst zoomLevel = ref(1)\r\nconst rotation = ref(0)\r\nconst imageViewerRef = ref(null)\r\nconst touchStartX = ref(0)\r\nconst touchStartY = ref(0)\r\nconst touchDistance = ref(0)\r\nconst isTouching = ref(false)\r\nconst imageLoading = ref(false)\r\nconst preloadedImages = ref<{ [key: string]: boolean }>({})\r\n\r\n// 图片预加载函数\r\nconst preloadImages = (images: string[], currentIndex: number) => {\r\n  if (!images || images.length === 0) return\r\n  \r\n  // 预加载当前图片、前一张和后一张\r\n  const indicesToPreload = [\r\n    currentIndex,\r\n    (currentIndex + 1) % images.length,\r\n    (currentIndex - 1 + images.length) % images.length\r\n  ]\r\n  \r\n  indicesToPreload.forEach(index => {\r\n    const imageUrl = images[index]\r\n    if (imageUrl && !preloadedImages.value[imageUrl]) {\r\n      const img = new Image()\r\n      img.src = imageUrl\r\n      img.onload = () => {\r\n        preloadedImages.value[imageUrl] = true\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 打开图片查看器\r\nconst openImageViewer = (index: number) => {\r\n  currentImageIndex.value = index\r\n  imageViewerVisible.value = true\r\n  \r\n  // 设置当前图片URL并显示加载状态\r\n  imageLoading.value = true\r\n  currentImageUrl.value = currentCase.value?.images?.[currentImageIndex.value] || ''\r\n  \r\n  // 重置缩放和旋转\r\n  zoomLevel.value = 1\r\n  rotation.value = 0\r\n  \r\n  // 预加载图片\r\n  if (currentCase.value?.images) {\r\n    preloadImages(currentCase.value.images, currentImageIndex.value)\r\n  }\r\n  \r\n  // 添加键盘事件监听\r\n  setTimeout(() => {\r\n    if (imageViewerRef.value) {\r\n      imageViewerRef.value.focus()\r\n    }\r\n    document.addEventListener('keydown', handleKeyDown)\r\n  }, 100)\r\n}\r\n\r\n// 关闭图片查看器\r\nconst closeImageViewer = () => {\r\n  imageViewerVisible.value = false\r\n  document.removeEventListener('keydown', handleKeyDown)\r\n}\r\n\r\n// 处理键盘事件\r\nconst handleKeyDown = (event: KeyboardEvent) => {\r\n  if (!imageViewerVisible.value) return\r\n\r\n  switch (event.key) {\r\n    case 'ArrowLeft':\r\n      prevImage()\r\n      break\r\n    case 'ArrowRight':\r\n      nextImage()\r\n      break\r\n    case 'Escape':\r\n      closeImageViewer()\r\n      break\r\n    case '+':\r\n      zoomIn()\r\n      break\r\n    case '-':\r\n      zoomOut()\r\n      break\r\n    case 'r':\r\n      rotateImage()\r\n      break\r\n  }\r\n}\r\n\r\n// 鼠标滚轮处理\r\nconst handleMouseWheel = (event: WheelEvent) => {\r\n  event.preventDefault()\r\n  if (event.deltaY < 0) {\r\n    zoomIn()\r\n  } else if (event.deltaY > 0) {\r\n    zoomOut()\r\n  }\r\n}\r\n\r\n// 图片操作\r\nconst zoomIn = () => {\r\n  zoomLevel.value = Math.min(zoomLevel.value + 0.1, 3)\r\n}\r\n\r\nconst zoomOut = () => {\r\n  zoomLevel.value = Math.max(zoomLevel.value - 0.1, 0.5)\r\n}\r\n\r\nconst rotateImage = () => {\r\n  rotation.value = (rotation.value + 90) % 360\r\n}\r\n\r\n// 切换图片\r\nconst prevImage = () => {\r\n  if (!currentCase.value?.images || currentCase.value.images.length <= 1) return\r\n  \r\n  imageLoading.value = true\r\n  currentImageIndex.value = (currentImageIndex.value - 1 + (currentCase.value.images.length)) % (currentCase.value.images.length)\r\n  currentImageUrl.value = currentCase.value.images[currentImageIndex.value] || ''\r\n  \r\n  // 预加载其他图片\r\n  preloadImages(currentCase.value.images, currentImageIndex.value)\r\n}\r\n\r\nconst nextImage = () => {\r\n  if (!currentCase.value?.images || currentCase.value.images.length <= 1) return\r\n  \r\n  imageLoading.value = true\r\n  currentImageIndex.value = (currentImageIndex.value + 1) % (currentCase.value.images.length)\r\n  currentImageUrl.value = currentCase.value.images[currentImageIndex.value] || ''\r\n  \r\n  // 预加载其他图片\r\n  preloadImages(currentCase.value.images, currentImageIndex.value)\r\n}\r\n\r\n// 图片加载完成事件\r\nconst handleImageLoad = () => {\r\n  imageLoading.value = false\r\n}\r\n\r\n// 下载当前图片\r\nconst downloadImage = () => {\r\n  if (!currentImageUrl.value) return\r\n  \r\n  try {\r\n    // 创建一个链接元素\r\n    const link = document.createElement('a')\r\n    link.href = currentImageUrl.value\r\n    \r\n    // 从URL中提取文件名，或使用默认名称\r\n    const filename = currentImageUrl.value.split('/').pop() || `case_image_${Date.now()}.jpg`\r\n    link.download = filename\r\n    \r\n    // 触发点击事件下载图片\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    \r\n    ElMessage({\r\n      type: 'success',\r\n      message: '图片下载已开始'\r\n    })\r\n  } catch (error) {\r\n    console.error('下载图片失败:', error)\r\n    ElMessage({\r\n      type: 'error',\r\n      message: '下载图片失败'\r\n    })\r\n  }\r\n}\r\n\r\n// 处理触摸开始事件\r\nconst handleTouchStart = (event: TouchEvent) => {\r\n  if (event.touches.length === 1) {\r\n    // 单指触摸，可能是滑动操作\r\n    touchStartX.value = event.touches[0].clientX\r\n    touchStartY.value = event.touches[0].clientY\r\n    isTouching.value = true\r\n  } else if (event.touches.length === 2) {\r\n    // 双指触摸，可能是缩放操作\r\n    const dx = event.touches[0].clientX - event.touches[1].clientX\r\n    const dy = event.touches[0].clientY - event.touches[1].clientY\r\n    touchDistance.value = Math.sqrt(dx * dx + dy * dy)\r\n  }\r\n}\r\n\r\n// 处理触摸移动事件\r\nconst handleTouchMove = (event: TouchEvent) => {\r\n  if (!isTouching.value) return\r\n  \r\n  if (event.touches.length === 1) {\r\n    // 单指滑动\r\n    const touchEndX = event.touches[0].clientX\r\n    const touchEndY = event.touches[0].clientY\r\n    const deltaX = touchEndX - touchStartX.value\r\n    \r\n    // 横向滑动超过50px时切换图片\r\n    if (Math.abs(deltaX) > 50) {\r\n      if (deltaX > 0) {\r\n        prevImage()\r\n      } else {\r\n        nextImage()\r\n      }\r\n      // 重置触摸状态\r\n      isTouching.value = false\r\n    }\r\n  } else if (event.touches.length === 2) {\r\n    // 双指缩放\r\n    const dx = event.touches[0].clientX - event.touches[1].clientX\r\n    const dy = event.touches[0].clientY - event.touches[1].clientY\r\n    const newDistance = Math.sqrt(dx * dx + dy * dy)\r\n    \r\n    // 计算缩放比例变化\r\n    if (touchDistance.value > 0) {\r\n      const scale = newDistance / touchDistance.value\r\n      if (scale > 1.05) {\r\n        zoomIn()\r\n        touchDistance.value = newDistance\r\n      } else if (scale < 0.95) {\r\n        zoomOut()\r\n        touchDistance.value = newDistance\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 处理触摸结束事件\r\nconst handleTouchEnd = () => {\r\n  isTouching.value = false\r\n  touchDistance.value = 0\r\n}\r\n\r\n// 在组件卸载时移除事件监听\r\nonUnmounted(() => {\r\n  document.removeEventListener('keydown', handleKeyDown)\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.app-container {\r\n  padding: 24px;\r\n  background-color: #f0f2f5;\r\n  min-height: 100vh;\r\n}\r\n\r\n.search-area {\r\n  margin-bottom: 24px;\r\n  background-color: #ffffff;\r\n  border-radius: 8px;\r\n  padding: 16px;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);\r\n  \r\n  .search-row {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 16px;\r\n    width: 100%;\r\n    \r\n    .search-input {\r\n      flex: 1;\r\n      max-width: calc((100% - 16px * 3 - 20%) / 3);\r\n    }\r\n    \r\n    .filter-select {\r\n      flex: 1;\r\n      max-width: calc((100% - 16px * 3 - 20%) / 3);\r\n    }\r\n    \r\n    .create-button {\r\n      width: 20%;\r\n      min-width: 120px;\r\n      max-width: 180px;\r\n    }\r\n    \r\n    @media (max-width: 1200px) {\r\n      gap: 12px;\r\n      \r\n      .search-input,\r\n      .filter-select {\r\n        max-width: calc((100% - 12px * 3 - 20%) / 3);\r\n      }\r\n      \r\n      .create-button {\r\n        min-width: 110px;\r\n      }\r\n    }\r\n    \r\n    @media (max-width: 992px) {\r\n      flex-wrap: wrap;\r\n      gap: 12px;\r\n      \r\n      .search-input,\r\n      .filter-select {\r\n        flex: 1;\r\n        min-width: calc(33.33% - 8px);\r\n        max-width: calc(33.33% - 8px);\r\n      }\r\n      \r\n      .create-button {\r\n        width: 100%;\r\n        max-width: none;\r\n        margin-top: 12px;\r\n      }\r\n    }\r\n    \r\n    @media (max-width: 768px) {\r\n      .search-input,\r\n      .filter-select {\r\n        width: 100%;\r\n        max-width: 100%;\r\n        min-width: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.case-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(3, 1fr);\r\n  gap: 20px;\r\n  \r\n  @media (max-width: 1200px) {\r\n    grid-template-columns: repeat(2, 1fr);\r\n  }\r\n  \r\n  @media (max-width: 768px) {\r\n    grid-template-columns: 1fr;\r\n  }\r\n}\r\n\r\n.case-card {\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  transition: all 0.3s ease;\r\n  position: relative;\r\n\r\n  &:hover {\r\n    box-shadow: 0 4px 10px -1px rgba(0, 0, 0, 0.1), 0 2px 6px -1px rgba(0, 0, 0, 0.06);\r\n    transform: translateY(-3px);\r\n    \r\n    .delete-button {\r\n      opacity: 1;\r\n    }\r\n  }\r\n  \r\n  .delete-button {\r\n    position: absolute;\r\n    top: 8px;\r\n    right: 8px;\r\n    z-index: 10;\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n    color: white;\r\n    width: 28px;\r\n    height: 28px;\r\n    border-radius: 50%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    cursor: pointer;\r\n    opacity: 0;\r\n    transition: all 0.3s ease;\r\n    \r\n    &:hover {\r\n      background-color: rgba(220, 38, 38, 0.8);\r\n      transform: scale(1.1);\r\n    }\r\n  }\r\n\r\n  .case-card-image-wrapper {\r\n    height: 160px;\r\n    position: relative;\r\n    overflow: hidden;\r\n    background-color: #f3f4f6;\r\n    flex-shrink: 0;\r\n    \r\n    .case-card-image {\r\n      width: 100%;\r\n      height: 100%;\r\n      object-fit: cover;\r\n      transition: transform 0.3s ease;\r\n    }\r\n    \r\n    &:hover .case-card-image {\r\n      transform: scale(1.05);\r\n    }\r\n    \r\n    .no-image {\r\n      width: 100%;\r\n      height: 100%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      color: #9ca3af;\r\n      \r\n      .el-icon {\r\n        font-size: 32px;\r\n        margin-bottom: 8px;\r\n      }\r\n      \r\n      span {\r\n        font-size: 13px;\r\n      }\r\n    }\r\n    \r\n    .image-count {\r\n      position: absolute;\r\n      right: 10px;\r\n      bottom: 10px;\r\n      background-color: rgba(0, 0, 0, 0.6);\r\n      color: white;\r\n      padding: 4px 8px;\r\n      border-radius: 16px;\r\n      font-size: 12px;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 4px;\r\n      z-index: 2;\r\n    }\r\n  }\r\n\r\n  .case-card-content {\r\n    padding: 14px;\r\n    flex: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .case-card-header {\r\n    margin-bottom: 12px;\r\n    \r\n    .case-id {\r\n      display: inline-block;\r\n      font-family: monospace;\r\n      color: #6b7280;\r\n      font-size: 12px;\r\n      padding: 2px 6px;\r\n      background: #f3f4f6;\r\n      border-radius: 4px;\r\n    }\r\n    \r\n    .case-card-title {\r\n      font-size: 15px;\r\n      font-weight: 600;\r\n      color: #1f2937;\r\n      margin: 6px 0 10px 0;\r\n      line-height: 1.4;\r\n      display: -webkit-box;\r\n      -webkit-line-clamp: 2;\r\n      -webkit-box-orient: vertical;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .tags-group {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 8px;\r\n    }\r\n  }\r\n\r\n  .time-section {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 6px;\r\n    margin-bottom: 10px;\r\n    \r\n    .time-tag {\r\n      display: flex;\r\n      align-items: center;\r\n      font-size: 12px;\r\n      color: #6b7280;\r\n      background-color: #f9fafb;\r\n      padding: 6px 10px;\r\n      border-radius: 6px;\r\n      border-left: 3px solid #909399;\r\n      \r\n      &.archive-time {\r\n        border-left-color: #67C23A;\r\n      }\r\n      \r\n      &.draft-time {\r\n        border-left-color: #909399;\r\n      }\r\n    }\r\n  }\r\n\r\n  .description-section {\r\n    margin-bottom: 10px;\r\n    \r\n    .description-text {\r\n      font-size: 13px;\r\n      color: #4b5563;\r\n      line-height: 1.5;\r\n      /* 设置最大高度，超出显示省略号 */\r\n      display: -webkit-box;\r\n      -webkit-line-clamp: 3;\r\n      -webkit-box-orient: vertical;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      max-height: 60px;\r\n    }\r\n  }\r\n\r\n  .users-section {\r\n    margin-top: auto;\r\n    \r\n    .users-row {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      gap: 8px;\r\n      padding-top: 6px;\r\n      border-top: 1px dashed #e5e7eb;\r\n    }\r\n    \r\n    .user-cell {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: flex-start;\r\n      \r\n      .user-label {\r\n        color: #6b7280;\r\n        font-size: 11px;\r\n        margin-bottom: 3px;\r\n      }\r\n      \r\n      .user-info {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 4px;\r\n        \r\n        .user-name {\r\n          font-size: 12px;\r\n          color: #374151;\r\n          max-width: 120px;\r\n          white-space: nowrap;\r\n          overflow: hidden;\r\n          text-overflow: ellipsis;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 详情页样式\r\n.case-detail {\r\n  background-color: #f0f2f5;\r\n  \r\n  .carousel-container {\r\n    margin-bottom: 24px;\r\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\r\n    border-radius: 12px;\r\n    overflow: hidden;\r\n    \r\n    :deep(.el-carousel__item) {\r\n      border-radius: 8px;\r\n      overflow: hidden;\r\n      cursor: pointer;\r\n      \r\n      &:hover .image-overlay {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    \r\n    .carousel-image-container {\r\n      width: 100%;\r\n      height: 300px;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      background-color: #f5f5f5;\r\n    }\r\n    \r\n    .carousel-image {\r\n      max-width: 100%;\r\n      max-height: 300px;\r\n      object-fit: contain;\r\n      transition: transform 0.3s;\r\n      \r\n      &:hover {\r\n        transform: scale(1.02);\r\n      }\r\n    }\r\n    \r\n    .image-overlay {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background-color: rgba(0, 0, 0, 0.5);\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: center;\r\n      align-items: center;\r\n      opacity: 0;\r\n      transition: opacity 0.3s;\r\n      cursor: pointer;\r\n      \r\n      .el-icon {\r\n        font-size: 32px;\r\n        color: white;\r\n        margin-bottom: 10px;\r\n      }\r\n      \r\n      .overlay-text {\r\n        color: white;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n  }\r\n  \r\n  .info-card {\r\n    border: 1px solid #e5e7eb;\r\n    overflow: hidden;\r\n    \r\n    .card-header {\r\n      background-color: #f9fafb;\r\n      \r\n      .section-title {\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        color: #333;\r\n        position: relative;\r\n        padding-left: 12px;\r\n        margin: 0;\r\n        \r\n        &::before {\r\n          content: '';\r\n          position: absolute;\r\n          left: 0;\r\n          top: 50%;\r\n          transform: translateY(-50%);\r\n          height: 16px;\r\n          width: 4px;\r\n          background-color: #409EFF;\r\n          border-radius: 2px;\r\n        }\r\n      }\r\n    }\r\n    \r\n    .card-body {\r\n      background-color: white;\r\n    }\r\n\r\n    .card-section-title {\r\n      font-size: 15px;\r\n      font-weight: 500;\r\n      color: #333;\r\n      position: relative;\r\n      padding-left: 10px;\r\n      \r\n      &::before {\r\n        content: '';\r\n        position: absolute;\r\n        left: 0;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        height: 14px;\r\n        width: 3px;\r\n        background-color: #909399;\r\n        border-radius: 2px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.description-content {\r\n  font-size: 15px;\r\n  line-height: 1.8;\r\n  color: #374151;\r\n  text-align: justify;\r\n  letter-spacing: 0.3px;\r\n  padding: 0 10px;\r\n}\r\n\r\n.case-number {\r\n  display: inline-block;\r\n  background-color: #f4f4f5;\r\n  color: #606266;\r\n  padding: 4px 10px;\r\n  border-radius: 4px;\r\n  font-family: monospace;\r\n  font-weight: 600;\r\n}\r\n\r\n:deep(.el-carousel__arrow) {\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  \r\n  &:hover {\r\n    background-color: rgba(0, 0, 0, 0.7);\r\n  }\r\n}\r\n\r\n:deep(.el-carousel__indicators) {\r\n  .el-carousel__button {\r\n    background-color: rgba(255, 255, 255, 0.4);\r\n    \r\n    &:hover {\r\n      background-color: rgba(255, 255, 255, 0.7);\r\n    }\r\n  }\r\n  \r\n  .is-active .el-carousel__button {\r\n    background-color: white;\r\n  }\r\n}\r\n\r\n.carousel-container {\r\n  margin: 16px 0;\r\n  position: relative;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  \r\n  &:hover {\r\n    .image-overlay {\r\n      opacity: 1;\r\n    }\r\n  }\r\n}\r\n\r\n.carousel-image-container {\r\n  width: 100%;\r\n  height: 300px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.carousel-image {\r\n  max-width: 100%;\r\n  max-height: 300px;\r\n  object-fit: contain;\r\n  transition: transform 0.3s;\r\n  \r\n  &:hover {\r\n    transform: scale(1.02);\r\n  }\r\n}\r\n\r\n.image-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  opacity: 0;\r\n  transition: opacity 0.3s;\r\n  cursor: pointer;\r\n  \r\n  .el-icon {\r\n    font-size: 32px;\r\n    color: white;\r\n    margin-bottom: 10px;\r\n  }\r\n  \r\n  .overlay-text {\r\n    color: white;\r\n    font-size: 14px;\r\n  }\r\n}\r\n\r\n.image-viewer-container {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.9);\r\n  z-index: 2000;\r\n  display: flex;\r\n  flex-direction: column;\r\n  backdrop-filter: blur(5px);\r\n}\r\n\r\n.image-viewer-header {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  padding: 16px;\r\n  \r\n  .close-button {\r\n    background-color: transparent;\r\n    border: none;\r\n    color: white;\r\n    font-size: 24px;\r\n    cursor: pointer;\r\n    \r\n    &:hover {\r\n      color: #f56c6c;\r\n    }\r\n  }\r\n}\r\n\r\n.image-viewer-body {\r\n  flex: 1;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  position: relative;\r\n  \r\n  .current-image {\r\n    max-width: 90%;\r\n    max-height: 80vh;\r\n    object-fit: contain;\r\n  }\r\n  \r\n  .nav-button {\r\n    position: absolute;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n    border: none;\r\n    color: white;\r\n    font-size: 24px;\r\n    width: 50px;\r\n    height: 50px;\r\n    border-radius: 50%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    cursor: pointer;\r\n    transition: background-color 0.3s;\r\n    \r\n    &:hover {\r\n      background-color: rgba(0, 0, 0, 0.8);\r\n    }\r\n    \r\n    &.prev {\r\n      left: 20px;\r\n    }\r\n    \r\n    &.next {\r\n      right: 20px;\r\n    }\r\n  }\r\n}\r\n\r\n// 添加键盘操作提示\r\n.keyboard-tips {\r\n  position: absolute;\r\n  bottom: 10px;\r\n  left: 0;\r\n  right: 0;\r\n  text-align: center;\r\n  color: rgba(255, 255, 255, 0.5);\r\n  font-size: 12px;\r\n}\r\n\r\n// 适配移动设备\r\n@media (max-width: 768px) {\r\n  .image-viewer-container {\r\n    .image-viewer-header {\r\n      padding: 10px;\r\n      \r\n      .image-counter {\r\n        font-size: 12px;\r\n      }\r\n    }\r\n    \r\n    .nav-button {\r\n      width: 36px;\r\n      height: 36px;\r\n      \r\n      .el-icon {\r\n        font-size: 16px;\r\n      }\r\n    }\r\n    \r\n    .keyboard-tips {\r\n      display: none; // 在移动设备上隐藏键盘提示\r\n    }\r\n  }\r\n}\r\n\r\n@keyframes rotate {\r\n  from { transform: rotate(0deg); }\r\n  to { transform: rotate(360deg); }\r\n}\r\n\r\n// 添加样式\r\n.detail-section {\r\n  border-bottom: 1px solid #ebeef5;\r\n  padding-bottom: 20px;\r\n  margin-bottom: 20px;\r\n  \r\n  &:last-child {\r\n    border-bottom: none;\r\n    margin-bottom: 0;\r\n    padding-bottom: 0;\r\n  }\r\n}\r\n\r\n.detail-header {\r\n  .section-title {\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: #333;\r\n    position: relative;\r\n    padding-left: 12px;\r\n    \r\n    &::before {\r\n      content: '';\r\n      position: absolute;\r\n      left: 0;\r\n      top: 50%;\r\n      transform: translateY(-50%);\r\n      height: 16px;\r\n      width: 4px;\r\n      background-color: #409EFF;\r\n      border-radius: 2px;\r\n    }\r\n  }\r\n}\r\n\r\n.detail-item {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 10px;\r\n  margin-bottom: 16px;\r\n  \r\n  .detail-label {\r\n    min-width: 80px;\r\n    font-size: 14px;\r\n    color: #606266;\r\n    text-align: right;\r\n  }\r\n  \r\n  .detail-value {\r\n    flex: 1;\r\n    font-size: 14px;\r\n    color: #303133;\r\n    word-break: break-word;\r\n    \r\n    &.empty {\r\n      color: #909399;\r\n      font-style: italic;\r\n    }\r\n  }\r\n}\r\n\r\n.case-type-tag, .status-tag {\r\n  font-size: 13px;\r\n  padding: 4px 10px;\r\n  font-weight: 600;\r\n  border-radius: 4px;\r\n  white-space: nowrap;\r\n}\r\n\r\n.category-tag {\r\n  font-size: 12px;\r\n  padding: 2px 8px;\r\n  height: 24px;\r\n  font-weight: 500;\r\n}\r\n\r\n.status-tag.el-tag--small {\r\n  font-size: 12px;\r\n  padding: 0 8px;\r\n  height: 22px;\r\n  line-height: 20px;\r\n  font-weight: 500;\r\n}\r\n\r\n.content-wrapper {\r\n  padding: 0 10px;\r\n  max-width: 100%;\r\n  width: 100%;\r\n  margin: 0 auto;\r\n}\r\n\r\n// 抽屉样式覆盖\r\n:deep(.el-drawer__header) {\r\n  margin-bottom: 0;\r\n  padding: 20px 24px;\r\n  border-bottom: 1px solid #e5e7eb;\r\n  \r\n  .drawer-actions {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n  }\r\n}\r\n\r\n:deep(.el-drawer__body) {\r\n  padding: 0;\r\n  background-color: #f0f2f5;\r\n}\r\n\r\n.basic-info-container {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 24px;\r\n  \r\n  @media (max-width: 768px) {\r\n    grid-template-columns: 1fr;\r\n  }\r\n  \r\n  .basic-info-item {\r\n    display: flex;\r\n    align-items: flex-start;\r\n    gap: 16px;\r\n    \r\n    .info-icon-box {\r\n      width: 40px;\r\n      height: 40px;\r\n      border-radius: 8px;\r\n      background-color: #ecf5ff;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      color: #409EFF;\r\n      font-size: 18px;\r\n      flex-shrink: 0;\r\n    }\r\n    \r\n    .info-content {\r\n      flex: 1;\r\n      \r\n      .info-label {\r\n        font-size: 13px;\r\n        color: #909399;\r\n        margin-bottom: 8px;\r\n      }\r\n      \r\n      .info-value {\r\n        font-size: 14px;\r\n        color: #303133;\r\n        font-weight: 500;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.archive-info-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 20px;\r\n  \r\n  @media (max-width: 640px) {\r\n    grid-template-columns: 1fr;\r\n  }\r\n  \r\n  .archive-info-item {\r\n    .info-row {\r\n      display: flex;\r\n      align-items: flex-start;\r\n      gap: 12px;\r\n    }\r\n    \r\n    .info-icon-container {\r\n      width: 40px;\r\n      height: 40px;\r\n      border-radius: 8px;\r\n      background-color: rgba(64, 158, 255, 0.1);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      flex-shrink: 0;\r\n      \r\n      .info-icon {\r\n        font-size: 18px;\r\n        color: #409EFF;\r\n      }\r\n    }\r\n    \r\n    .info-content {\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: center;\r\n      \r\n      .info-label {\r\n        font-size: 13px;\r\n        color: #909399;\r\n        margin-bottom: 8px;\r\n      }\r\n      \r\n      .info-value {\r\n        font-size: 14px;\r\n        color: #303133;\r\n        font-weight: 500;\r\n        \r\n        &.user-value {\r\n          display: flex;\r\n          align-items: center;\r\n          gap: 10px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"names":["getCaseList","params","request","getCaseDetail","id","createCase","data","deleteCase","userStore","useUserStore","currentUserRole","ref","hasDeletePermission","computed","role","loading","loadingDetail","drawerVisible","currentCase","searchQuery","caseTypeFilter","cases","getCaseTypeType","case_type","getCaseTypeLabel","getStatusType","status","getStatusLabel","truncateText","text","maxLength","getAvatarUrl","name","handleSearch","openDrawer","item","res","detailData","ElMessage","error","handleCreateCase","createDialogVisible","newCase","formRules","createFormRef","fileList","submitting","handleFileChange","uploadFile","reader","handleFileRemove","file","handleExceed","beforeUpload","submitNewCase","valid","formData","fetchCases","resetForm","_a","onMounted","_b","deleting","confirmDelete","ElMessageBox","handleDeleteCase","imageViewerVisible","currentImageIndex","currentImageUrl","zoomLevel","rotation","imageViewerRef","touchStartX","touchStartY","touchDistance","isTouching","imageLoading","preloadedImages","preloadImages","images","currentIndex","index","imageUrl","img","openImageViewer","_c","handleKeyDown","closeImageViewer","event","prevImage","nextImage","zoomIn","zoomOut","rotateImage","handleMouseWheel","handleImageLoad","downloadImage","link","filename","handleTouchStart","dx","dy","handleTouchMove","touchEndX","deltaX","newDistance","scale","handleTouchEnd","onUnmounted"],"mappings":"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"}