{"version":3,"file":"index-DZVj9Kiz.js","sources":["../../src/views/login/index.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-form\n      ref=\"formRef\"\n      :model=\"loginForm\"\n      :rules=\"loginRules\"\n      class=\"login-form\"\n    >\n      <h3 class=\"title\">文知管理系统</h3>\n      <el-form-item prop=\"username\">\n        <el-input\n          v-model=\"loginForm.username\"\n          placeholder=\"用户名\"\n          type=\"text\"\n        >\n          <template #prefix>\n            <el-icon><User /></el-icon>\n          </template>\n        </el-input>\n      </el-form-item>\n      <el-form-item prop=\"password\">\n        <el-input\n          v-model=\"loginForm.password\"\n          placeholder=\"密码\"\n          type=\"password\"\n        >\n          <template #prefix>\n            <el-icon><Lock /></el-icon>\n          </template>\n        </el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button\n          :loading=\"loading\"\n          type=\"primary\"\n          style=\"width: 100%\"\n          @click=\"handleLogin\"\n        >\n          登录\n        </el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { ElMessage } from 'element-plus'\nimport { User, Lock } from '@element-plus/icons-vue'\nimport type { FormInstance, FormRules } from 'element-plus'\nimport { useUserStore } from '@/stores/user'\nimport { login } from '@/api/auth'\nimport type { LoginForm, LoginResponse } from '@/types/auth'\n\nconst router = useRouter()\nconst userStore = useUserStore()\nconst formRef = ref<FormInstance>()\n\nconst loading = ref(false)\nconst loginForm = ref<LoginForm>({\n  username: '',\n  password: ''\n})\n\nconst loginRules = {\n  username: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\n  password: [{ required: true, message: '请输入密码', trigger: 'blur' }]\n}\n\nconst handleLogin = async () => {\n  if (!formRef.value) return\n  \n  await formRef.value.validate()\n  \n  try {\n    loading.value = true\n    const { data } = await login(loginForm.value)\n    const loginData = data.data as LoginResponse\n    const { token, refreshToken, expires, userInfo } = loginData\n    \n    userStore.setToken(token, refreshToken, expires)\n    userStore.setUserInfo({\n      ...userInfo,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString()\n    })\n    \n    ElMessage.success('登录成功')\n    router.push('/dashboard')\n  } catch (error) {\n    console.error('Login failed:', error)\n  } finally {\n    loading.value = false\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.login-container {\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #2d3a4b;\n  \n  .login-form {\n    width: 400px;\n    padding: 40px 35px;\n    background: #fff;\n    border-radius: 4px;\n    \n    .title {\n      text-align: center;\n      margin: 0 0 30px;\n      color: #333;\n    }\n  }\n}\n</style> "],"names":["router","useRouter","userStore","useUserStore","formRef","ref","loading","loginForm","loginRules","handleLogin","data","login","loginData","token","refreshToken","expires","userInfo","ElMessage","error"],"mappings":"uQAuDA,MAAMA,EAASC,EAAU,EACnBC,EAAYC,EAAa,EACzBC,EAAUC,EAAkB,EAE5BC,EAAUD,EAAI,EAAK,EACnBE,EAAYF,EAAe,CAC/B,SAAU,GACV,SAAU,EAAA,CACX,EAEKG,EAAa,CACjB,SAAU,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,EACjE,SAAU,CAAC,CAAE,SAAU,GAAM,QAAS,QAAS,QAAS,MAAQ,CAAA,CAClE,EAEMC,EAAc,SAAY,CAC1B,GAACL,EAAQ,MAEP,OAAAA,EAAQ,MAAM,SAAS,EAEzB,GAAA,CACFE,EAAQ,MAAQ,GAChB,KAAM,CAAE,KAAAI,CAAK,EAAI,MAAMC,EAAMJ,EAAU,KAAK,EACtCK,EAAYF,EAAK,KACjB,CAAE,MAAAG,EAAO,aAAAC,EAAc,QAAAC,EAAS,SAAAC,CAAa,EAAAJ,EAEzCV,EAAA,SAASW,EAAOC,EAAcC,CAAO,EAC/Cb,EAAU,YAAY,CACpB,GAAGc,EACH,WAAY,IAAI,KAAK,EAAE,YAAY,EACnC,WAAY,IAAI,KAAK,EAAE,YAAY,CAAA,CACpC,EAEDC,EAAU,QAAQ,MAAM,EACxBjB,EAAO,KAAK,YAAY,QACjBkB,EAAO,CACN,QAAA,MAAM,gBAAiBA,CAAK,CAAA,QACpC,CACAZ,EAAQ,MAAQ,EAAA,EAEpB"}