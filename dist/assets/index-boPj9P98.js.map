{"version":3,"file":"index-boPj9P98.js","sources":["../../src/views/login/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <el-form\r\n      ref=\"formRef\"\r\n      :model=\"loginForm\"\r\n      :rules=\"loginRules\"\r\n      class=\"login-form\"\r\n    >\r\n      <h3 class=\"title\">文知管理系统</h3>\r\n      <el-form-item prop=\"username\">\r\n        <el-input\r\n          v-model=\"loginForm.username\"\r\n          placeholder=\"用户名\"\r\n          type=\"text\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon><User /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <el-input\r\n          v-model=\"loginForm.password\"\r\n          placeholder=\"密码\"\r\n          type=\"password\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon><Lock /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button\r\n          :loading=\"loading\"\r\n          type=\"primary\"\r\n          style=\"width: 100%\"\r\n          @click=\"handleLogin\"\r\n        >\r\n          登录\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\nimport { User, Lock } from '@element-plus/icons-vue'\r\nimport type { FormInstance, FormRules } from 'element-plus'\r\nimport { useUserStore } from '@/stores/user'\r\nimport { login } from '@/api/auth'\r\nimport type { LoginForm, LoginResponse } from '@/types/auth'\r\n\r\nconst router = useRouter()\r\nconst userStore = useUserStore()\r\nconst formRef = ref<FormInstance>()\r\n\r\nconst loading = ref(false)\r\nconst loginForm = ref<LoginForm>({\r\n  username: '',\r\n  password: ''\r\n})\r\n\r\nconst loginRules = {\r\n  username: [{ required: true, message: '请输入用户名', trigger: 'blur' }],\r\n  password: [{ required: true, message: '请输入密码', trigger: 'blur' }]\r\n}\r\n\r\nconst handleLogin = async () => {\r\n  if (!formRef.value) return\r\n  \r\n  await formRef.value.validate()\r\n  \r\n  try {\r\n    loading.value = true\r\n    const { data } = await login(loginForm.value)\r\n    const loginData = data.data as LoginResponse\r\n    const { token, refreshToken, expires, userInfo } = loginData\r\n    \r\n    userStore.setToken(token, refreshToken, expires)\r\n    userStore.setUserInfo({\r\n      ...userInfo,\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString()\r\n    })\r\n    \r\n    ElMessage.success('登录成功')\r\n    router.push('/dashboard')\r\n  } catch (error) {\r\n    console.error('Login failed:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.login-container {\r\n  min-height: 100vh;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: #2d3a4b;\r\n  \r\n  .login-form {\r\n    width: 400px;\r\n    padding: 40px 35px;\r\n    background: #fff;\r\n    border-radius: 4px;\r\n    \r\n    .title {\r\n      text-align: center;\r\n      margin: 0 0 30px;\r\n      color: #333;\r\n    }\r\n  }\r\n}\r\n</style> "],"names":["router","useRouter","userStore","useUserStore","formRef","ref","loading","loginForm","loginRules","handleLogin","data","login","loginData","token","refreshToken","expires","userInfo","ElMessage","error"],"mappings":"uQAuDA,MAAMA,EAASC,EAAU,EACnBC,EAAYC,EAAa,EACzBC,EAAUC,EAAkB,EAE5BC,EAAUD,EAAI,EAAK,EACnBE,EAAYF,EAAe,CAC/B,SAAU,GACV,SAAU,EAAA,CACX,EAEKG,EAAa,CACjB,SAAU,CAAC,CAAE,SAAU,GAAM,QAAS,SAAU,QAAS,OAAQ,EACjE,SAAU,CAAC,CAAE,SAAU,GAAM,QAAS,QAAS,QAAS,MAAQ,CAAA,CAClE,EAEMC,EAAc,SAAY,CAC1B,GAACL,EAAQ,MAEP,OAAAA,EAAQ,MAAM,SAAS,EAEzB,GAAA,CACFE,EAAQ,MAAQ,GAChB,KAAM,CAAE,KAAAI,CAAK,EAAI,MAAMC,EAAMJ,EAAU,KAAK,EACtCK,EAAYF,EAAK,KACjB,CAAE,MAAAG,EAAO,aAAAC,EAAc,QAAAC,EAAS,SAAAC,CAAa,EAAAJ,EAEzCV,EAAA,SAASW,EAAOC,EAAcC,CAAO,EAC/Cb,EAAU,YAAY,CACpB,GAAGc,EACH,WAAY,IAAI,KAAK,EAAE,YAAY,EACnC,WAAY,IAAI,KAAK,EAAE,YAAY,CAAA,CACpC,EAEDC,EAAU,QAAQ,MAAM,EACxBjB,EAAO,KAAK,YAAY,QACjBkB,EAAO,CACN,QAAA,MAAM,gBAAiBA,CAAK,CAAA,QACpC,CACAZ,EAAQ,MAAQ,EAAA,EAEpB"}